{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="{% static 'main/style.css' %}">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

  {% block extra_head %}{% endblock %}
</head>

<body>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" defer></script>

  <nav class="navbar navbar-expand-lg navbar-light bg-white border-bottom shadow-sm fixed-top">
    <div class="container">
      <!-- ë¡œê³  -->
      <a class="navbar-brand fw-bold" href="{% url 'main:home' %}">ì§€ê¸ˆ ì„œìš¸</a>

      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNavbar">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse justify-content-between" id="mainNavbar">

        <!-- ì™¼ìª½: 1~5 ëŒ€ì£¼ì œ -->
        <ul class="navbar-nav">
          <li class="nav-item dropdown hover-dropdown">
            <a class="nav-link dropdown-toggle" href="#">ì˜¤ëŠ˜ì˜ ì„œìš¸</a>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="#">ì‹¤ì‹œê°„ ë‚ ì”¨</a></li>
              <li><a class="dropdown-item" href="#">êµí†µìƒí™©</a></li>
              <li><a class="dropdown-item" href="#">ì¬ë‚œ/ì•ˆì „ ì•Œë¦¼</a></li>
              <li><a class="dropdown-item" href="#">ì˜¤ëŠ˜ì˜ í–‰ì‚¬</a></li>
              <li><a class="dropdown-item" href="#">ë¯¸ì„¸ë¨¼ì§€ í˜„í™©</a></li>
            </ul>
          </li>

          <li class="nav-item dropdown hover-dropdown">
            <a class="nav-link dropdown-toggle" href="#">ë³µì§€Â·ìƒí™œì§€ì›</a>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="#">ì²­ë…„ì§€ì›</a></li>
              <li><a class="dropdown-item" href="#">ì–´ë¥´ì‹  ë³µì§€</a></li>
              <li><a class="dropdown-item" href="#">ì•„ë™/ì²­ì†Œë…„ ë³µì§€</a></li>
              <li><a class="dropdown-item" href="#">ì¥ì• ì¸ ì§€ì›</a></li>
              <li><a class="dropdown-item" href="#">ì£¼ê±°ë³µì§€</a></li>
            </ul>
          </li>

          <li class="nav-item dropdown hover-dropdown">
            <a class="nav-link dropdown-toggle" href="#">êµìœ¡Â·ìê¸°ê³„ë°œ</a>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="#">í‰ìƒí•™ìŠµ</a></li>
              <li><a class="dropdown-item" href="#">ë¬¸í™”ì„¼í„° ê°•ì¢Œ</a></li>
              <li><a class="dropdown-item" href="#">ì˜¨ë¼ì¸ ê°•ì˜</a></li>
              <li><a class="dropdown-item" href="#">ì™¸êµ­ì–´/ìê²©ì¦</a></li>
              <li><a class="dropdown-item" href="#">ì²­ì†Œë…„ ì§„ë¡œ</a></li>
            </ul>
          </li>

          <li class="nav-item dropdown hover-dropdown">
            <a class="nav-link dropdown-toggle" href="#">ì—¬ê°€Â·ë¬¸í™”</a>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="#">ê³µì—°/ì „ì‹œ</a></li>
              <li><a class="dropdown-item" href="#">ì¶•ì œ ì •ë³´</a></li>
              <li><a class="dropdown-item" href="#">ê³µì›/ì‚°ì±…ë¡œ</a></li>
              <li><a class="dropdown-item" href="#">ì•¼ì™¸ ì˜í™”</a></li>
              <li><a class="dropdown-item" href="#">ê·¼êµ ë‚˜ë“¤ì´</a></li>
            </ul>
          </li>

          <li class="nav-item dropdown hover-dropdown">
            <a class="nav-link dropdown-toggle" href="#">ê±´ê°•Â·ì˜ë£Œ</a>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="#">ê³µê³µë³‘ì›/ë³´ê±´ì†Œ</a></li>
              <li><a class="dropdown-item" href="#">ê±´ê°•ê²€ì§„</a></li>
              <li><a class="dropdown-item" href="#">ê°ì—¼ë³‘ ì •ë³´</a></li>
              <li><a class="dropdown-item" href="#">ì‹ìƒí™œ/ìš´ë™</a></li>
            </ul>
          </li>
          <li class="nav-item">
            <a class="nav-link {% if request.resolver_match.url_name == 'chatbot' %}active{% endif %}" href="{% url 'main:chatbot' %}">ì±—ë´‡</a>
          </li>
          <li class="nav-item">
            <a class="nav-link {% if request.resolver_match.url_name == 'board_list' %}active{% endif %}" href="{% url 'main:board_list' %}">ê²Œì‹œíŒ</a>
          </li>
        </ul>

        <!-- ì˜¤ë¥¸ìª½: ì±—ë´‡ / ê²Œì‹œíŒ / ë¡œê·¸ì¸ -->
        <ul class="navbar-nav align-items-center">

          {% if request.user.is_authenticated %}
            <li class="nav-item">
              <span class="navbar-text me-2">{{ request.user.first_name }}ë‹˜, í™˜ì˜í•©ë‹ˆë‹¤!</span>
            </li>
            <li class="nav-item">
              <a class="btn btn-outline-secondary" href="{% url 'main:logout' %}">ë¡œê·¸ì•„ì›ƒ</a>
            </li>
          {% else %}
            <li class="nav-item">
              <a class="btn btn-outline-primary me-2" href="{% url 'main:login' %}">ë¡œê·¸ì¸</a>
            </li>
          {% endif %}
        </ul>

      </div>
    </div>
  </nav>

  <div class="main-content" style="margin-top: 56px;">
    {% block content %}
    {% endblock %}
  </div>
  {% block extra_scripts %}{% endblock %}
</body>
<!-- widget - Chatbot Modal -->
  <div id="chatbot-container" style="
      display: none;
      position: fixed;
      bottom: 100px;
      right: 20px;
      width: 400px;   /* í•„ìš”ì— ë”°ë¼ ì¡°ì ˆ */
      height: 600px;  /* í•„ìš”ì— ë”°ë¼ ì¡°ì ˆ */
      z-index: 9999;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      border-radius: 12px;
      overflow: hidden;
      background: white;
  ">
    <iframe src="/floating_chatbot/widget/" frameborder="0" style="width: 100%; height: 100%;"></iframe>
  </div>
  <!-- widget - Chatbot Floating Button -->
  <div id="chatbot-button" {% if request.user.is_authenticated %} onclick="toggleChatbot()" {% else %} onclick="goLoginPage()" {% endif %} style="position: fixed; bottom: 24px; right: 24px; background-color: #007bff; color: white; font-size: 28px; width: 60px; height: 60px; border-radius: 50%; text-align: center; line-height: 60px; box-shadow: 0 4px 8px rgba(0,0,0,0.2); cursor: pointer; z-index: 9999;">
    ğŸ’¬
  </div>
  <script>
    function goLoginPage(){
      window.location.href = "/login/";
    }
  function toggleChatbot() {
    const chatbot = document.getElementById("chatbot-container");
    chatbot.style.display = chatbot.style.display === "none" ? "block" : "none";
  }
  </script>
</html>
